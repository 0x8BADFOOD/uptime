<h1>Checks <small id="last_update"></small></h1>
<table id="check_summary">
  <thead>
    <tr><th><span class="label success">Up</span></th><th><span class="label important">Down</label></th></tr>
  </thead>
  <tbody>
    <tr><td id="all_up" class="green"></td><td id="all_down" class="red"></td></tr>
  </tbody>
</table>
<table id="checks">
  <thead>
    <tr><th>Name</th><th>Up?</th><th>Uptime</th><th>Avg. Response time</th><th>Up for</th></tr>
  </thead>
  <tbody></tbody>
</table>
<script src="<%= route %>/javascripts/jquery.timeago.js"></script>
<script>
jQuery(document).ready(function($) {
  $.timeago.settings.strings.suffixAgo = null;
  var updateChecks = function() {
    $.getJSON('/api/check', function(checks) {
      var all_up = all_down = 0;
      var lines = [];
      $.each(checks, function(key, check) {
        if (check.isUp) all_up += 1; else all_down += 1;
        lines.push(new EJS({ url: '<%= route %>/partials/check.ejs' }).render({ check: check, route: '<%= route %>' }));
      });
      $('#checks tbody').html(lines.join(''));
      $('#all_up').text(all_up);
      $('#all_down').text(all_down);
      $('#last_update').text('Last updated on ' + new Date().toLocaleString());
    });
  }
  updateChecks();
  window.setInterval(updateChecks, 5000);
});
</script>
